# Neonatal Hypoxic-Ischemic Encephalopathy (HIE) Lesion Segmentation in MRI Using Deep Learning

This project focuses on the segmentation of neonatal hypoxic-ischemic encephalopathy (HIE) lesions using MRI scans. Using deep learning methods, particularly the U-Net model with a VGG16 backbone, this project aims to improve diagnostic accuracy by segmenting small, diffuse lesions in neonates affected by HIE.

## Table of Contents

- [Project Structure](#project-structure)
- [Installation](#installation)
- [Usage](#usage)
  - [Preprocessing](#preprocessing)
  - [Training, Testing, Evaluation and Prediction](#training-testing-evaluation-and-prediction)
- [Contributing](#contributing)
- [License](#license)

## Project Structure

The repository contains the following main directories and files:

- `Preprocessing/`: Contains scripts for preprocessing the MRI images (ADC, Z_ADC) to standardize input data before model training and combine them to enhance lesion segmentation performance.
- `Train_Test/`: Contains scripts for training, testing, evaluating the model on the dataset and predicting it.
- `ADC/`: Processed ADC images for training the model on ADC modality.
- `Fusion/`: Contains fused images generated by combining ADC and Z_ADC images for training the model on the Fusion modality.
- `Z_ADC/`: Contains Z-score normalized ADC (Z_ADC) images for training the model on the Z_ADC modality.
- `README.md`: The current documentation file.

## Installation

To set up this project, install the necessary dependencies and prepare the dataset.

### 1. Clone the repository
Clone the project repository to your local machine:

```bash
git clone https://github.com/BONBIDHIE/UNet_vgg16.git
```

### 2. Navigate to the project directory
```bash
cd UNet_vgg16
```

### 3. Install the required dependencies
Use the following command to install the necessary libraries:

```bash
pip install -r requirements.txt
```

This will install TensorFlow, SimpleITK, OpenCV, and other libraries needed for image processing and model training.

## Usage

1. **Preprocessing**:
   - The `Preprocessing` folder contains scripts to preprocess MRI images, including resizing, cropping, and normalization.

2. **Training and Testing**:
   - The model training and testing scripts are contained in the `Train_Test` folder. Run the following command to train the model on the processed data, for instance:
   
     ```bash
     python Train_Test/classified_ADC_unet_vgg16_fold1.py
     ```

3. **Evaluation and Prediction**:
   - Model evaluation and prediction are also performed in the same script `classified_ADC_unet_vgg16_fold1.py`. This script will output segmentation masks for given input MRI images and save evaluation metrics.


## Contributing

We welcome contributions to enhance this project. To contribute:

1. **Fork** the repository.
2. **Clone** your forked repository.
3. Create a **new branch** for your changes:
   ```bash
   git checkout -b feature-name
   ```
4. **Commit** your changes:
   ```bash
   git commit -am "Add new feature"
   ```
5. **Push** the changes:
   ```bash
   git push origin feature-name
   ```
6. Open a **pull request**.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.


